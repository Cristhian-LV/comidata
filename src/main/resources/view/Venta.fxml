<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<AnchorPane fx:id="miContenedor" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="pe.edu.upeu.comidata.Controladores.VentaController">
    <children>
        <VBox spacing="5.0" AnchorPane.leftAnchor="5.0" AnchorPane.rightAnchor="5.0" AnchorPane.topAnchor="5.0">
            <Label text="Datos del Cliente" style="-fx-font-weight: bold;" />
            <GridPane hgap="10.0" vgap="5.0">
                <columnConstraints>
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="150.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="100.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="200.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="250.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="120.0" />
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints minHeight="30.0" prefHeight="30.0" vgrow="SOMETIMES" />
                    <RowConstraints minHeight="30.0" prefHeight="30.0" vgrow="SOMETIMES" />
                </rowConstraints>

                <Label text="Buscar Cliente (DNI):" GridPane.rowIndex="0" />
                <TextField fx:id="autocompCliente" promptText="Buscar o Ingresar DNI" GridPane.rowIndex="1" />

                <Button maxHeight="1.7976931348623157E308" maxWidth="1.7976931348623157E308" mnemonicParsing="false" onAction="#buscarClienteCdni" style="-fx-background-color: #133558; -fx-text-fill: white;" text="Buscar" GridPane.columnIndex="1" GridPane.rowSpan="2" />

                <Label text="DNI/RUC:" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                <TextField fx:id="dniRuc" GridPane.columnIndex="2" GridPane.rowIndex="1" editable="false" />

                <Label text="Nombre / Razón Social:" GridPane.columnIndex="3" GridPane.rowIndex="0" />
                <TextField fx:id="razonSocial" GridPane.columnIndex="3" GridPane.rowIndex="1" editable="false" />

                <Label text="Dirección:" GridPane.columnIndex="4" GridPane.rowIndex="0" />
                <TextField fx:id="direccionCliente" GridPane.columnIndex="4" GridPane.rowIndex="1" editable="false" />
            </GridPane>
        </VBox>

        <VBox spacing="5.0" layoutY="80.0" AnchorPane.leftAnchor="5.0" AnchorPane.rightAnchor="5.0" AnchorPane.topAnchor="80.0">
            <Label text="Añadir Producto al Carrito" style="-fx-font-weight: bold;" />
            <GridPane hgap="10.0" vgap="5.0">
                <columnConstraints>
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="200.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="150.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="70.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="100.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="100.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="100.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="100.0" />
                    <ColumnConstraints hgrow="SOMETIMES" prefWidth="70.0" />
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints minHeight="30.0" prefHeight="30.0" vgrow="SOMETIMES" />
                    <RowConstraints minHeight="30.0" prefHeight="30.0" vgrow="SOMETIMES" />
                </rowConstraints>

                <Label text="Buscar Producto:" GridPane.rowIndex="0" />
                <TextField fx:id="autocompProducto" promptText="Buscar por nombre o código" GridPane.rowIndex="1" />

                <Label text="Producto (Nombre):" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                <TextField fx:id="nombreProducto" GridPane.columnIndex="1" GridPane.rowIndex="1" editable="false" />

                <Label text="Stock:" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                <TextField fx:id="stockPro" GridPane.columnIndex="2" GridPane.rowIndex="1" editable="false" />

                <Label text="P.Unitario (S/):" GridPane.columnIndex="3" GridPane.rowIndex="0" />
                <TextField fx:id="punitPro" GridPane.columnIndex="3" GridPane.rowIndex="1" editable="false" />

                <Label text="Cantidad:" GridPane.columnIndex="4" GridPane.rowIndex="0" />
                <TextField fx:id="cantidadPro" onKeyTyped="#calcularPT" promptText="Cantidad" GridPane.columnIndex="4" GridPane.rowIndex="1" />

                <Label text="P. Total (S/):" GridPane.columnIndex="5" GridPane.rowIndex="0" />
                <TextField fx:id="preTPro" GridPane.columnIndex="5" GridPane.rowIndex="1" editable="false" />

                <Label text="Promo. %:" GridPane.columnIndex="6" GridPane.rowIndex="0" />
                <TextField fx:id="txtDescuentoPromo" GridPane.columnIndex="6" GridPane.rowIndex="1" editable="false" />

                <Button fx:id="btnRegCarrito" maxHeight="1.7976931348623157E308" maxWidth="1.7976931348623157E308" mnemonicParsing="false" onAction="#registrarCarrito" style="-fx-background-color: #6c757d; -fx-text-fill: white;" text="Añadir" GridPane.columnIndex="7" GridPane.rowSpan="2" />
            </GridPane>
        </VBox>

        <VBox layoutY="170.0" spacing="5.0" AnchorPane.leftAnchor="5.0" AnchorPane.rightAnchor="5.0" AnchorPane.topAnchor="170.0" AnchorPane.bottomAnchor="80.0">
            <Label text="Contenido del Carrito" style="-fx-font-weight: bold;" />
            <TableView fx:id="tableView" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="colProducto" text="Producto" prefWidth="250" />
                    <TableColumn fx:id="colCantidad" text="Cant." prefWidth="70" />
                    <TableColumn fx:id="colPrecioUnitario" text="P. Unit. (S/)" prefWidth="100" />
                    <TableColumn fx:id="colDescuento" text="Desc. (%)" prefWidth="80" />
                    <TableColumn fx:id="colSubtotal" text="SubTotal (S/)" prefWidth="120" />
                    <TableColumn fx:id="colAcciones" text="Acciones" prefWidth="80" />
                </columns>
            </TableView>
        </VBox>

        <AnchorPane layoutX="5.0" prefHeight="70.0" AnchorPane.bottomAnchor="5.0" AnchorPane.leftAnchor="5.0" AnchorPane.rightAnchor="5.0">
            <children>
                <HBox alignment="CENTER_RIGHT" spacing="20.0" AnchorPane.bottomAnchor="5.0" AnchorPane.rightAnchor="5.0" AnchorPane.topAnchor="5.0">
                    <children>
                        <VBox alignment="CENTER_RIGHT" spacing="5.0">
                            <children>
                                <HBox spacing="10.0">
                                    <Label text="Sub Total:" />
                                    <Label fx:id="lblSubTotal" alignment="CENTER_RIGHT" prefWidth="80.0" text="0.00" />
                                </HBox>
                                <HBox spacing="10.0">
                                    <Label text="Impuesto (IGV):" />
                                    <Label fx:id="lblIgv" alignment="CENTER_RIGHT" prefWidth="80.0" text="0.00" />
                                </HBox>
                                <HBox spacing="10.0">
                                    <Label text="Total a Pagar:" style="-fx-font-weight: bold;" />
                                    <Label fx:id="lblTotalPagar" alignment="CENTER_RIGHT" prefWidth="80.0" style="-fx-font-weight: bold;" text="0.00" />
                                </HBox>
                            </children>
                        </VBox>

                        <VBox spacing="5.0">
                            <Button fx:id="btnLimpiarCarrito" mnemonicParsing="false" onAction="#limpiarCarrito" prefHeight="25.0" prefWidth="150.0" style="-fx-background-color: #dc3545; -fx-text-fill: white;" text="Limpiar Carrito" />
                            <Button fx:id="btnGenerarVenta" mnemonicParsing="false" onAction="#generarVenta" prefHeight="35.0" prefWidth="150.0" style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-font-size: 16px;" text="Generar Pedido" />
                        </VBox>
                    </children>
                </HBox>
            </children>
        </AnchorPane>
    </children>
</AnchorPane>